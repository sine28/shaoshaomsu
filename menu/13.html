<?php
$pdo = new PDO("mysql:host=localhost;dbname=mydb", "root", "");
$rentals = $pdo->query("SELECT * FROM rentals ORDER BY created_at DESC")->fetchAll(PDO::FETCH_ASSOC);
?>
<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πà‡∏≤</title>
<style>
    body { font-family: Arial; background: #f5f6fa; padding: 20px; }
    table { width: 100%; border-collapse: collapse; background: white; }
    th, td { padding: 10px; border-bottom: 1px solid #ddd; }
    th { background: #f0f0f0; }
    .status { padding: 5px 10px; border-radius: 5px; color: white; }
    .pending { background: orange; }
    .delivery { background: dodgerblue; }
    .inuse { background: green; }
    .done { background: gray; }
</style>
<script>
function updateStatus(id, status) {
    fetch("update_status.php", {
        method: "POST",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body: "rental_id=" + id + "&status=" + status
    }).then(() => location.reload());
}
</script>
</head>
<body>

<h2>üìã ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πà‡∏≤</h2>
<table>
<tr>
    <th>‡∏£‡∏´‡∏±‡∏™‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πà‡∏≤</th>
    <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤</th>
    <th>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</th>
    <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡πà‡∏≤</th>
    <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
    <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
</tr>
<?php foreach($rentals as $r): ?>
<tr>
    <td><?= $r['rental_id'] ?></td>
    <td><?= $r['renter_name'] ?></td>
    <td><?= $r['product_id'] ?></td>
    <td><?= $r['created_at'] ?></td>
    <td>
        <span class="status 
            <?= $r['status']=='‡∏£‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πà‡∏≤'?'pending':
                ($r['status']=='‡∏£‡∏≠‡∏£‡∏±‡∏ö-‡∏™‡πà‡∏á'?'delivery':
                ($r['status']=='‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô'?'inuse':'done')) ?>">
            <?= $r['status'] ?>
        </span>
    </td>
    <td>
        <select onchange="updateStatus(<?= $r['rental_id'] ?>, this.value)">
            <option value="">-- ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ --</option>
            <option value="‡∏£‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πà‡∏≤">‡∏£‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πà‡∏≤</option>
            <option value="‡∏£‡∏≠‡∏£‡∏±‡∏ö-‡∏™‡πà‡∏á">‡∏£‡∏≠‡∏£‡∏±‡∏ö-‡∏™‡πà‡∏á</option>
            <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</option>
            <option value="‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</option>
        </select>
    </td>
</tr>
<?php endforeach; ?>
</table>

</body>
</html>
